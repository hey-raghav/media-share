<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<style>
body {
  margin: 0;
  background: transparent;
  font-family: Arial, sans-serif;
}
#alert {
  display: none;
  padding: 20px 30px;
  background: rgba(0,0,0,0.75);
  color: white;
  font-size: 28px;
  border-radius: 12px;
}
</style>
</head>
<body>

<div id="alert"></div>

<script>
const alertBox = document.getElementById("alert");
let hideTimer = null;
let ws;

/* ---- WebSocket with auto-reconnect ---- */
function connectWS() {
  ws = new WebSocket(
    location.protocol === "https:"
      ? "wss://" + location.host
      : "ws://" + location.host
  );

  ws.onmessage = e => {
    const q = JSON.parse(e.data);
    if (!q.length) return;

    alertBox.textContent = `${q[0].name} donated â‚¹30`;
    alertBox.style.display = "block";

    if (hideTimer) clearTimeout(hideTimer);
    hideTimer = setTimeout(() => {
      alertBox.style.display = "none";
    }, 10000);
  };

  ws.onclose = () => {
    setTimeout(connectWS, 2000);
  };
}

connectWS();

/* ---- Keep browser source alive ---- */
setInterval(() => {
  // tiny DOM touch to prevent OBS idle freeze
  alertBox.style.opacity = "1";
}, 60000); // every 1 minute
</script>

</body>
</html>
